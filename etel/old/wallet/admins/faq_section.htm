<?
###############################################################################
## PROGRAM     : Dopays.com - The First Open Source Payment Gateway          ##
## VERSION     : 2.80                                                        ##
## AUTHOR(S)   : Dmitry Pereuda, dmitry@pereuda.com                          ##
##               Oleg Ostaplyuck, oleg@ostaplyuk.com                         ##
## COMPANY     : Dosware Team                                                ##
## COPYRIGHTS  : (C)2003 Dosware Team. All Rights Reserved                   ##
##                                                                           ##
## LICENSE     : http://www.gnu.org/copyleft/gpl.html                        ##
###############################################################################
## Dopays  is free software;  you can redistribute it and/or modify it under ##
## the terms of the  GNU  General Public License as published  by  the  Free ##
## Software Foundation; either version 2 of the License, or (at your option) ##
## any later version.                                                        ##
##                                                                           ##
## Dopays is distributed in the hope that it will be useful, but WITHOUT ANY ##
## WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS ##
## FOR A PARTICULAR PURPOSE.  See the  GNU General Public License  for  more ##
## details.                                                                  ##
##                                                                           ##
## TO COMPLY WITH THIS LICENSE, PLEASE DO NOT REMOVE THE LINK TO THE DOSWARE ##
## WEBSITE FROM YOUR COPY OF THE SCRIPT.  THIS IS THE LEAST YOU  CAN  DO  TO ##
## SUPPORT THE DEVELOPMENT OF DOPAYS.COM!                                    ##
##                                                                           ##
## You should have received a copy of the  GNU  General Public License along ##
## with this program; if not, you can find it here:                          ##
##    http://www.gnu.org/copyleft/gpl.html                                   ##
## or write to the:                                                          ##
##    Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA ##
###############################################################################
$data['PageName']='FAQ Section';
$data['PageFile']='faq_section';
###############################################################################
include('../config.htm');
###############################################################################
if(!$_SESSION['adm_login']){
	header("Location:{$data['Admins']}/login.htm");
	echo('ACCESS DENIED.');
	exit;
	
}
###############################################################################
if(!$post['action'])$post['action']='select';
###############################################################################
if ($_POST['change_section']){
	$qr1 = mysql_query("SELECT * FROM dp_faq_cat_list");
	$max = 0;
	while ($a = mysql_fetch_object($qr1)){
		$x[$a->id] = 1;
		if ($a->id > $max) $max = $a->id;
		if (preg_match("/update/i", $_POST['change_section'])){
			mysql_query(
				"UPDATE dp_faq_cat_list SET title='".
				addslashes($_POST["title$a->id"])."' WHERE id=$a->id"
			);
		}
	}
	for ($i = 0; $i <= $max; $i++){
		if (!$x[$i]) break;
		$sel_id = $i;
	}
	if (preg_match("/delete/i", $_POST['change_section']) && $_POST['delete']){
		$id = (int)$_POST['delete'];
		mysql_query("DELETE FROM dp_faq_cat_list WHERE id=$id");
	}
	if (preg_match("/add/i", $_POST['change_section']) && $_POST['title_new'] != ''){
		mysql_query(
			"INSERT INTO dp_faq_cat_list SET title='".
			addslashes($_POST['title_new'])."'") or die( mysql_error()
		);
	}
}
###############################################################################
$data['SystemBalance']=select_balance(-1);
###############################################################################
display('admins');
###############################################################################
?>